

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Problems With Using the GLM to Model fMRI Data &#8212; fMRI Single-subject Statistical Modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5.glm-fmri-problems';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Single-subject Modelling in SPM" href="6.single-subject-spm.html" />
    <link rel="prev" title="Using the GLM to Model fMRI Data" href="4.glm-fmri.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="fMRI Single-subject Statistical Modelling - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="fMRI Single-subject Statistical Modelling - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.need-for-modelling.html">The Need for Statistical Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.glm.html">The General Linear Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.glm-example.html">The GLM: A Worked Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.glm-fmri.html">Using the GLM to Model fMRI Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Problems With Using the GLM to Model fMRI Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.single-subject-spm.html">Single-subject Modelling in SPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.summary-quiz.html">Summary and Quiz</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/martynmcfarquhar/NCCN-IA-fMRIPreProcessing" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/martynmcfarquhar/NCCN-IA-fMRIPreProcessing/issues/new?title=Issue%20on%20page%20%2F5.glm-fmri-problems.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5.glm-fmri-problems.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Problems With Using the GLM to Model fMRI Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-1-the-shape-and-timing-of-the-bold-response">Issue 1: The Shape and Timing of the BOLD Response</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-2-autocorrelation">Issue 2: Autocorrelation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-3-low-frequency-noise">Issue 3: Low-frequency Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-4-image-scaling">Issue 4: Image Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-adapted-glm">The Adapted GLM</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="problems-with-using-the-glm-to-model-fmri-data">
<h1>Problems With Using the GLM to Model fMRI Data<a class="headerlink" href="#problems-with-using-the-glm-to-model-fmri-data" title="Permalink to this heading">#</a></h1>
<p>Although we have now seen one way of using the GLM to model fMRI data, there are several problems with the approach described in the prevous section. These include issues with the shape and timing of the BOLD response, the correlation structure of time series data, the presence of low-frequency noise and the arbitrary scaling of BOLD data. Much of the early research into the mass-univariate method was concerned with identifying and providing solutions to these problems. This can be seen in a series of papers from Friston and colleagues called <a class="reference external" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/hbm.460010207">Analysis of the fMRI time-series</a>, <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/9343589/">Analysis of the fMRI time-series - revisited</a>, and <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/9343600/">nalysis of the fMRI time-series - revisited – again</a>. These papers demonstrate how it took a number of years to identify and solve the problems that accompany applying the GLM to fMRI data. Even to this day, some of the “solutions” used by SPM are contentious. As such, it is important to understand both the problems and their purported solutions in order to understand some of the limitations of the analysis approach we will be using going forward.</p>
<section id="issue-1-the-shape-and-timing-of-the-bold-response">
<h2>Issue 1: The Shape and Timing of the BOLD Response<a class="headerlink" href="#issue-1-the-shape-and-timing-of-the-bold-response" title="Permalink to this heading">#</a></h2>
<p>The first main problem with the approach described in the previous section is the <em>shape</em> and <em>timing</em> of the predictor variables. So far, we have used a dummy variable to indicate the onset and offset of the experimental conditions. This implies an instantaneous change in signal at the start of each experimental condition, as well as an instantaneous change in signal at the end of the experimental condition. However, as we know, the BOLD response is far from instantaneous. In <a class="reference internal" href="#hrf-fig"><span class="std std-numref">Fig. 14</span></a> we can see a typical BOLD response to a stimulus at time 0.</p>
<figure class="align-default" id="hrf-fig">
<a class="reference internal image-reference" href="_images/hrf.png"><img alt="_images/hrf.png" src="_images/hrf.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Illustration of a typical BOLD response to a single stimulus at time 0.</span><a class="headerlink" href="#hrf-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Notice how it takes around 6 seconds for the signal to reach its peak and around 20 seconds to come back to baseline. As such, if we use a dummy variable we run the risk of our model not fitting the data simply because the actual BOLD response is offset from the stimulus onsets. This lack of fit will lead to larger residuals and a larger variance estimate. This will directly impact the magnitude of the standard errors, leading to a less sensitive model. This issue is illustrated in <a class="reference internal" href="#bad-fit-fig"><span class="std std-numref">Fig. 15</span></a>.</p>
<figure class="align-default" id="bad-fit-fig">
<a class="reference internal image-reference" href="_images/bad-fit.png"><img alt="_images/bad-fit.png" src="_images/bad-fit.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Illustration of how a dummy variable leads to poor correspondance with the BOLD signal given the delayed response to the stimuli.</span><a class="headerlink" href="#bad-fit-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>One solution would be to offset our dummy variable in time to accommodate the delayed response. This would help improve the fit to an extent, but we would still not be capturing the shape of the actual response. In order to do this, we turn to the process of convolution, which we discussed during the Functional Neuroanatomy module. By convolving our dummy variable with a model of the hemodynamic response, we can create a much more realistic prediction of what our signal should look like, as shown below.</p>
<p>This model of the hemodynamic response is known as the hemodynamic response function (HRF), and was derived using de-convolution methods by several authors in the mid-90s. The specific version shown above is referred to as the canonical HRF by SPM, and is derived from combining two gamma distributions. This is all we are going to say about this for now. The derivation of the HRF and the justification for the use of convolution is part of assuming that the relationship between the neural signal and the hemodynamic signal is linear and time-invariant (LTI). This is something we will discuss in more detail in the Experimental Design and Optimisation module. For now, just to show that this is a good idea, the illustration below shows the results of using a raw dummy variable and a convolved dummy variable on the magnitude of the model errors.</p>
<p>As a final point, after convolution our predictor is no longer a dummy variable and is more akin to a continuous predictor variable, as shown below. However, trying to think about the parameters as regression slopes can become a bit unintuitive when trying to think about changes in relation to experimental conditions. Luckily, we can still think of the parameters as capturing changes in signal magnitude. Because the parameters scale the height of our predictor variable, a larger parameter estimate still means a larger signal change relative to the baseline. So we can think of these parameter estimates in the same way as those from a dummy variable, even after convolution.</p>
</section>
<section id="issue-2-autocorrelation">
<h2>Issue 2: Autocorrelation<a class="headerlink" href="#issue-2-autocorrelation" title="Permalink to this heading">#</a></h2>
<p>Another issue with our approach thus far is that we have not acknowledged that we are working with time series data. What is so special about a time series? Well, one little detail we have not indicated so far is that all the theory behind the GLM is based on assuming that the data in Y are independent. This means there is no correlation between the data points. Why does this matter? Well, correlation actually has quite a big impact on the structure of the variance and thus on the standard errors. So far, we have just used the GLM as if our timeseries contains no correlation, but unfortunately timeseries data have a very specific correlation structure known as autocorrelation. This means that values close to one another in time are closer in value (more correlated) than values far away in time. So we need to take this into account, otherwise our standard errors will be wrong and any subsequent inference will be inaccurate.</p>
<p>In order to accommodate this correlation, SPM starts by doing an initial model fit at every voxel and then estimating the correlation structure in the data using the residuals. This is done using an autoregressive model of order 1, also known as an AR(1) model, which is given by</p>
<div class="math notranslate nohighlight">
\[
\epsilon_{t} = \rho \epsilon_{t-1} + \tau_{t}
\]</div>
<p>So this is an enhanced version of the errors we saw previously, where the term ρεt-1 has been added. Here ρ is the correlation and εt-1 is the error one step back in time. This effectively scales the influence of the previous error value on the current error value. The higher the correlation the more of the previous error there will be in the current error. The main consequence of this is that when you calculate the covariance of the errors you get</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}\left(\epsilon_{t},\epsilon_{t+n}\right) = \frac{\sigma^{2}}{1-\rho^{2}}\rho^{|n|}
\]</div>
<p>which means that the correlation gets weaker the further apart in time the data points are. This therefore captures a simple version of autocorrelation that can be estimated efficiently by SPM using maximum likelihood methods. Of note is that SPM does not estimate the correlation uniquely at each voxel. Instead, it pools together voxels that survive an initial thresholding and then uses those voxels to estimate a single correlation structure, which is assumed to be the same everywhere in the brain. This is done in the name of speed and efficiency, but clearly is far from desirable in terms of the assumptions that have to be made.</p>
<p>Once SPM has an estimate of the AR(1) correlation structure, it uses it to create a whitening matrix. How it does this is not important (you can look at pages 195-6 in Poldrack, Mumford &amp; Nichols, 2011, if you are curious), all we need to know is that this whitening matrix (denoted W) can be used to remove the correlation from the data. SPM does this by pre-multiplying the data and design</p>
<div class="math notranslate nohighlight">
\[
\mathbf{WY} = \mathbf{WX}\boldsymbol{\beta} + \mathbf{W}\boldsymbol{\epsilon}
\]</div>
<p>So after the whitening procedure our data and our design matrix will be different. This is because removing the correlation from the data breaks the connection between the data and the predictor variables, as the shape of the BOLD response will be changed by the whitening. In order to make sure our predictor variables are still able to predict the signal accurately, we also have to change them with the whitening matrix. This means that you will see the design matrix change colour in SPM during the statistical modelling. This is one of the reasons why.</p>
</section>
<section id="issue-3-low-frequency-noise">
<h2>Issue 3: Low-frequency Noise<a class="headerlink" href="#issue-3-low-frequency-noise" title="Permalink to this heading">#</a></h2>
<p>A third issue we face with applying the GLM to fMRI data is that the timeseries is often contaminated by low-frequency noise, also known as signal drift. For example, the timeseries below shows a steady increase in signal magnitude over time.</p>
<p>The problem with the drift is that it will bias the parameter estimates. For instance, we may get the impression that the signal change is larger in one experimental condition simply because there were repeats closer to the end of the experiment when the signal was larger than at the start of the experiment. Unfortunately, the cause of the drift relates to the scanners themselves and thus is difficult to avoid. As such, we have to find a way of removing this drift from the data instead.</p>
<p>The way SPM does this is by high-pass filtering the data. This is done using a discrete cosine transform (DCT) basis set. This is essentially a series of cosines increasing in frequency up to the desired filter cutoff, as shown below. The high-pass filter can be enacted by adding the DCT basis set as extra columns in the design matrix. This works in a similar fashion to the Fourier transform, in the sense that a linear combination of periodic functions can be used to represent any signal. In this case, the cosines will act together to remove any frequency below the cutoff from the data.</p>
<p>In order to not clutter up the design matrix, SPM actually takes a slightly different approach (which works out the same as adding the cosines to the design matrix). What SPM does is use the cosines to form a filtering matrix (denoted S) which can be used to pre-multiply the data and design, much in the same way as whitening.</p>
<div class="math notranslate nohighlight">
\[
\mathbf{SY} = \mathbf{SX}\boldsymbol{\beta} + \mathbf{S}\boldsymbol{\epsilon}
\]</div>
<p>So this removes the low-frequencies from the data and the design, using the same principles as the whitening procedure. The only element of this we need to concern ourselves with is what cutoff to use. By default SPM chooses 128 seconds, which is equivalent to 1/128 = 0.008Hz. So any frequency below 0.008Hz will be removed from the data. Practically, this means we should design our experiments so that any periodic changes of interest (such as our experimental conditions) do not occur slower than around every 2 minutes, otherwise we run the risk of removing experimental signal with the filter. As we will see, there are facilities within SPM that can be used to find a suitable filter value and this is something we will also come back to in the Experimental Design and Optimisation module. This filtering is also another reason why you will see the design matrix change colour during the course of the analysis in SPM.</p>
</section>
<section id="issue-4-image-scaling">
<h2>Issue 4: Image Scaling<a class="headerlink" href="#issue-4-image-scaling" title="Permalink to this heading">#</a></h2>
<p>The final issue that we have not considered is that the BOLD signal itself is measured on an arbitrary scale that can differ from subject-to-subject or scanner-to-scanner. The problem is that the GLM parameters are on the same scale as the data. For instance, β1 gives the change in signal for a unit change in our first predictor variable. Unfortunately, this means we cannot meaningfully compare the magnitude of these parameters between subjects, because their value depends upon the arbitrary scale of the signal. To get around this, SPM will scale the data such that the mean of the data over all voxels and all volumes is equal to 100. This is known as grand mean scaling and will effectively put all our subjects on the same scale. This is done completely automatically in the background for you, so why do we care? Well you have to be slightly careful about interpretation here because the temptation might be to think that this scaling renders the parameters on some sort of standardised and interpretable scale, such as percentage signal change. However, this is not correct and the actual procedure to convert the parameters to percentage signal change is much more involved (as explained by Pernet (2014)). So note that SPM automatically scales the data, but remember this does not result in some standardised and easy to interpret metric for our effects.</p>
</section>
<section id="the-adapted-glm">
<h2>The Adapted GLM<a class="headerlink" href="#the-adapted-glm" title="Permalink to this heading">#</a></h2>
<p>So we have now seen that in order to make the GLM work with fMRI data we have to convolve our dummy variables with the HRF, estimate and remove the autocorrelation in the data, filter the data to remove low-frequency noise and scale the data to put it on a common scale across all subjects. All these steps form an adapted version of the GLM, as illustrated below</p>
<p>where the “star” symbol indicates the whitened and filtered versions of the data, design matrix and errors. Once the parameters have been estimated, they can be used to multiply each column to scale the prediction to best match the data, as shown below. Notice how the constant takes on the baseline level of signal (400 in this example) and that the conditions are simply changes relative to this baseline.</p>
<p>Adding all the scaled columns together provides our final model prediction, giving us a clear perspective on what the GLM is doing to try and separate the true signal from noise.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "jupyter_matlab_kernel"
        },
        kernelOptions: {
            name: "jupyter_matlab_kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'jupyter_matlab_kernel'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="4.glm-fmri.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Using the GLM to Model fMRI Data</p>
      </div>
    </a>
    <a class="right-next"
       href="6.single-subject-spm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Single-subject Modelling in SPM</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-1-the-shape-and-timing-of-the-bold-response">Issue 1: The Shape and Timing of the BOLD Response</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-2-autocorrelation">Issue 2: Autocorrelation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-3-low-frequency-noise">Issue 3: Low-frequency Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#issue-4-image-scaling">Issue 4: Image Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-adapted-glm">The Adapted GLM</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>